<!DOCTYPE html>
<html>
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
      <link rel="stylesheet" href="/stylesheets/styles.css">
      <title>ISBN Lookup!</title>
    </head>
    
    
    
   <body>
    <div class="container">

      <!--Query-->
      <div class="jumbotron">
        <h1>Open Library</h1>
        <p>Please enter the ISBN of the book you're looking to retrive</p>
        <form action="index.hbs" method="get">
          <label class="col-sm-2">ISBN</label>
          <input id="inputNum" class="col-sm-4" type="text" name="number">
          <button class="btn btn-primary col-sm-6" type="button" id="isbnLookup" name="isbnLookup">Query</button>
        </form>
      </div>

      <!--Result-->
      <div class="cover col-sm-3">
      </div>
      <div class="info col-sm-4">
      </div>

    </div>

    <script>
    isbnLookup.addEventListener("click", function(){
        
    $(".info").empty();
    $(".cover").empty();


    var ISBN = $("#inputNum").val();
    $.ajax({
        method: "GET",
        url: "https://openlibrary.org/api/books",
        dataType: "json",
        data: {
          "bibkeys" : ISBN,
          "format" : "json",
          "jscmd" : "data"
        },
        success: function(book, status) {

          var results = book[ISBN];

          var title = results["title"];
          var author = results["by_statement"];
          var publishYear = results["publish_date"];
          var publishers = results["publishers"];
          var pages = results["number_of_pages"];

          var linkObj = results["cover"];
          var link = linkObj["medium"];

          var img = "<div class='cover col-sm-3'><img src='" + link + "'></div>"

          $(".cover").append(img);

          $(".info").append("Title: " + title + "<br>");
          $(".info").append("Author: " + author + "<br>");
          $(".info").append("Publish: " + publishYear + "<br>");
          $(".info").append("Publisher: " + publishers[0].name + "<br>");
          $(".info").append("ISBN: " + ISBN + "<br>");
          $(".info").append("Pages: " + pages + "<br>");
        }
    });
})    
        
    </script>
  </body>
</html>